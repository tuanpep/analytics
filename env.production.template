# Plausible Analytics Production Environment Configuration
# Copy this file to .env and update the values for your production environment

# =============================================================================
# REQUIRED CONFIGURATION - UPDATE THESE VALUES
# =============================================================================

# Your domain or IP address (REQUIRED)
BASE_URL=https://your-domain.com

# Secret key for session encryption (REQUIRED - generate with: openssl rand -base64 64)
SECRET_KEY_BASE=REPLACE_WITH_GENERATED_SECRET_KEY_BASE

# TOTP vault key for 2FA (generate with: openssl rand -base64 32)
TOTP_VAULT_KEY=REPLACE_WITH_GENERATED_TOTP_VAULT_KEY

# Environment
ENVIRONMENT=prod

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database URL (using Docker service names)
DATABASE_URL=postgres://plausible:plausible@postgres:5432/plausible

# ClickHouse Database URL (using Docker service names)
CLICKHOUSE_DATABASE_URL=http://clickhouse:8123/plausible?user=default&password=

# ClickHouse Performance Configuration
CLICKHOUSE_MAX_BUFFER_SIZE_BYTES=500000
CLICKHOUSE_FLUSH_INTERVAL_MS=3000
CLICKHOUSE_INGEST_POOL_SIZE=10

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Server settings
PORT=8000
LISTEN_IP=0.0.0.0
SECURE_COOKIE=true

# Logging
LOG_LEVEL=notice
LOG_FORMAT=standard

# =============================================================================
# USER MANAGEMENT
# =============================================================================

# Admin user IDs (comma-separated)
ADMIN_USER_IDS=1

# Registration settings (disable for production)
DISABLE_REGISTRATION=true

# Email verification (enable for production)
ENABLE_EMAIL_VERIFICATION=true

# =============================================================================
# EMAIL CONFIGURATION (Configure for production)
# =============================================================================

# Email adapter - Configure SMTP for production
MAILER_ADAPTER=Bamboo.SMTPAdapter
SMTP_HOST_ADDR=smtp.your-email-provider.com
SMTP_HOST_PORT=587
SMTP_USER_NAME=your-smtp-username
SMTP_USER_PWD=your-smtp-password
SMTP_HOST_SSL_ENABLED=true
SMTP_RETRIES=2
SMTP_NO_MX_LOOKUPS=true

# =============================================================================
# GEOLOCATION CONFIGURATION
# =============================================================================

# MaxMind License Key (for GeoLite2 database) - Get from MaxMind
MAXMIND_LICENSE_KEY=your-maxmind-license-key

# =============================================================================
# MONITORING & ANALYTICS (Optional but recommended)
# =============================================================================

# Sentry for error tracking - Configure for production monitoring
SENTRY_DSN=your-sentry-dsn

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================

# Self-hosted mode
SELFHOST=true

# Disable cron jobs (set to false for production)
DISABLE_CRON=false

# Session timeout (in minutes)
SESSION_LENGTH_MINUTES=60

# Custom script name (for tracker)
CUSTOM_SCRIPT_NAME=script

# Log failed login attempts (enable for security)
LOG_FAILED_LOGIN_ATTEMPTS=true

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# OpenTelemetry sampler ratio (lower for production)
OTEL_SAMPLER_RATIO=0.01

# Import buffer size (higher for production)
IMPORTED_MAX_BUFFER_SIZE=50000

# =============================================================================
# SECURITY
# =============================================================================

# Enable session transfer (disable for higher security)
ENABLE_SESSION_TRANSFER=false

# =============================================================================
# BACKUP AND MAINTENANCE
# =============================================================================

# Backup configuration (used by deployment scripts)
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"

# =============================================================================
# SLACK NOTIFICATIONS (Optional)
# =============================================================================

# Slack webhook URL for deployment notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK